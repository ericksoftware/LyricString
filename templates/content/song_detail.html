{% extends "base.html" %}

{% load static %}

{% block title %}{{ song.title }} - {{ song.artist.name }} - LyricString{% endblock %}

{% block extra_css %}

{% endblock %}

{% block content %}

<link rel="stylesheet" href="{% static 'css/song_detail.css' %}">
<div class="song-hero">
    <div class="song-artwork">
        {% if song.cover_image %}
        <img src="{{ song.cover_image.url }}" alt="{{ song.title }} cover">
        {% else %}
        <i class="fas fa-guitar"></i>
        {% endif %}
        <button class="play-button">
            <i class="fas fa-play"></i>
        </button>
    </div>
    
    <div class="song-meta">
        <h1>{{ song.title }}</h1>
        <div class="artist">{{ song.artist.name }}</div>
        
        <div class="song-info-grid">
            <div class="info-item">
                <div class="info-label">Duration</div>
                <div class="info-value">{{ song.duration|time:"i:s" }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">Key</div>
                <div class="info-value">{{ song.key }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">BPM</div>
                <div class="info-value">{{ song.bpm }}</div>
            </div>
            <div class="info-item">
                <div class="info-label">Year</div>
                <div class="info-value">{{ song.year }}</div>
            </div>
        </div>
        
        <div class="genre-tag">
            {% for genre in song.genres.all %}
            {{ genre.name }}{% if not forloop.last %}, {% endif %}
            {% endfor %}
        </div>
        
        <div class="action-buttons">
            <button class="action-btn primary">
                <i class="fas fa-play"></i> Play Song
            </button>
            <button class="action-btn secondary">
                <i class="fas fa-heart"></i> Like
            </button>
            <button class="action-btn secondary">
                <i class="fas fa-bookmark"></i> Save
            </button>
            <button class="action-btn secondary">
                <i class="fas fa-share"></i> Share
            </button>
        </div>
    </div>
</div>

<div class="content-section">
    <h2 class="section-title">
        <i class="fas fa-music"></i> Song Information
    </h2>
    <p style="color: #b0b0b0; line-height: 1.6; font-size: 1.1rem;">
        {{ song.description }}
    </p>
</div>

<div class="content-section">
    <h2 class="section-title">
        <i class="fas fa-guitar"></i> Instruments & Difficulty
    </h2>
    <div class="instruments-grid">
        {% for song_instrument in song.songinstrument_set.all %}
        <div class="instrument-card">
            <div class="instrument-icon">
                <i class="{{ song_instrument.instrument.icon_class }}"></i>
            </div>
            <div class="instrument-name">{{ song_instrument.instrument.name }}</div>
            <span class="difficulty-badge difficulty-{{ song_instrument.difficulty }}">
                {{ song_instrument.difficulty|title }}
            </span>
        </div>
        {% endfor %}
    </div>
</div>

<div class="content-section">
    <h2 class="section-title">
        <i class="fas fa-music"></i> Chord Progression
    </h2>
    <div class="chord-progression">
        {% for chord in chords %}
        <div class="chord-item">
            <div class="chord-name">{{ chord.chord_name }}</div>
            <div class="chord-type">{{ chord.chord_type }}</div>
        </div>
        {% endfor %}
    </div>
</div>

<div class="content-section">
    <h2 class="section-title">
        <i class="fas fa-file-alt"></i> Lyrics & Tabs
    </h2>
    
    <div class="tabs-container">
        <div class="tab-buttons">
            <button class="tab-btn active" data-tab="lyrics">Lyrics</button>
            {% if 'Electric Guitar' in tabs_by_instrument %}
            <button class="tab-btn" data-tab="guitar-tabs">Guitar Tabs</button>
            {% endif %}
            {% if 'Bass Guitar' in tabs_by_instrument %}
            <button class="tab-btn" data-tab="bass-tabs">Bass Tabs</button>
            {% endif %}
        </div>
        
        <div class="tab-content active" id="lyrics">
            <div class="lyrics-container">
                {% for section_type, sections in lyrics_by_section.items %}
                {% for section in sections %}
                {% if section.section_type != 'verse' or forloop.first %}
                <strong>[{{ section.section_type|title }}]</strong><br>
                {% endif %}
                {{ section.content|linebreaksbr }}<br><br>
                {% endfor %}
                {% endfor %}
            </div>
        </div>
        
        {% if 'Electric Guitar' in tabs_by_instrument %}
        <div class="tab-content" id="guitar-tabs">
            <div class="lyrics-container">
                {{ tabs_by_instrument.Electric Guitar|linebreaksbr }}
            </div>
        </div>
        {% endif %}
        
        {% if 'Bass Guitar' in tabs_by_instrument %}
        <div class="tab-content" id="bass-tabs">
            <div class="lyrics-container">
                {{ tabs_by_instrument.Bass Guitar|linebreaksbr }}
            </div>
        </div>
        {% endif %}
    </div>
</div>

<!-- Rest of your JavaScript remains the same -->
{% endblock %}